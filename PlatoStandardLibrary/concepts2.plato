
concept Interval<T: Numerical>
    inherits Vector<T>
{
    field Min: T;
    field Max: T;  
}

concept Vector<T: Numerical> 
    inherits Array<T>, Value, Numerical, Arithmetic<T>
{
}

concept Measure
    inherits Value, ScalarArithemetic<Number>, Equatable, Comparable, Magnitude
{ 
    field Value: Number;
}

concept Numerical 
    inherits Value, Arithmetic, Equatable, Comparable, Magnitude
{
    function FromNumber(x: Number): Self
        = Values.FromNumber(x);
}

concept Magnitude
    inherits Value
{
    function Magnitude(x: Self): Number
        = x.Values.Square.Sum.SquareRoot;
}

concept Comparable
    inherits Value
{
    function Compare(a: Self, b: Self): Integer
        = a.Magnitude < b.Magnitude ? : -1 : a.Magnitude > b.Magnitude ? 1 : 0;
}

concept Equatable
    inherits Value
{
    function Equals(a: Self, b: Self): Boolean
        = a.Values.Equals(b.Values).All;
}

concept Arithmetic
    inherits Value
{ 
    function Add(self: Self, other: Self): Self
        = self.Values.Add(other.Values);

    function Negative(self: Self): Self
        = self.Values.Negative;

    function Reciprocal(self: Self): Self
        = self.Values.Reciprocal;
    
    function Multiply(self: Self, other: Self): Self
        = self.Values.Add(other.Values);

    function Divide(self: Self, other: Self): Self
        = self.Values.Divide(other.Values);

    function Modulo(self: Self, other: Self): Self
        = self.Values.Modulo(other.Values);
}

concept ScalarArithmetic<T>
    inherits Value
{
    function Add(self: Self, scalar: T): Self
        = self.Values.Add(scalar);
    
    function Subtract(self: Self, scalar: T): Self
        = self.Add(scalar.Negative);

    function Multiply(self: Self, scalar: T): Self
        = self.Values.Multiply(scalar);
    
    function Divide(self: Self, scalar: T): Self
        = self.Multiply(scalar.Reciprocal);

    function Modulo(self: Self, scalar: T): Self
        = self.Values.Modulo(scalar);
}

concept Value 
{
    function Type(): Type
        = intrinsic;

    function FieldTypes(): Array<Type>
        = intrinsic;

    function FieldNames(): Array<String>
        = intrinsic;

    function Value(self: Self, n: Index): Value
        = intrinsic;

    function FieldValues(self: Self): Array<Value>
        = NumFields.Select(x => GetValue(self, x));

    function FieldTypes(): Array<Type>
        = Fields.Item2;

    function Zero(): Self
        = Types.Zero;

    function One(): Self
        = Types.One;

    function Default(): Self
        = Types.Default;

    function MinValue(): Self
        = Types.MinValue;

    function MaxValue(): Self
        = Types.MaxValue;

    function ToString(x: Self): String
        = Values.JoinString(",");
}

concept Array<T: Any>
{
    field Count: Count;    
    function At(n: Index): T;
}
